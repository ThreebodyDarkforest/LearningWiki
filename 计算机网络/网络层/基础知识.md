# 基础知识

## 概述

- 作用
	- 发送方主机网络层：将运输层报文段封装成数据报
	- 接收方：解封报文段，交给运输层
- 网络层功能
	- 转发：与路由器内部结构有关
		- 路由表：分组首部和相应输出链路的键值对，由路由协议更新
	- 选路：选路算法，与全网路由协议有关
- 术语
	- 分组交换机
		- 链路层交换机：根据链路层数据转发
		- 路由器：根据网络层数据转发
- 提供服务：尽力而为服务，不保证可靠

## 虚电路和数据报网络

- 服务
	- 无连接和面向连接
	- 主机到主机
	- 端系统和主机都要实现
- 虚电路网络
	- 组成
		- 源和目的地之间的一条连接路径
		- VC号：每条链路的号码
		- 路由器转发表中的表项
	- 工作原理
		- 在源和目的之间创建一个VC
		- 源向该VC发送带有VC号的分组
		- 每经过一台中间路由器，用新的VC号代替原VC号： 从VC号转发表获得
		- 分组在每条链路上的VC号不同
	- 通信过程
	- 转发表结构：入接口，入VC，出接口，出VC
		- 创建新的VC，其转发表中就增加一项
		- 终止一个VC，其转发表中就删除对应项
		- 路由器维护连接状态直到释放
	- 过程
		- 建立：决定所有分 组要通过的一系列链路与路由器，并为每条链路确定一个VC号
		- 传输
		- 拆除：其中一方通知其网络层终止该虚电路
- 数据报网络
	- 特性
		- 无连接
		- 分组使用目的主机地址转发
	- 转发
		- 根据到达分组的目的地址在转发表中查询，找到相应的输出链路接口， 并将分组转发出去
		- 转发表
			- 目的地址与链路接口的映射表（最大前缀匹配）
			- 只维持转发状态信息
			- 转发表由选路算法修改
		- 一批分组可能在网络中选择不同的路径，到达的顺序可能不一致
	- 与虚电路区别
		- 虚电路路由器知道所有虚电路，数据报路由器不知道运输层连接
