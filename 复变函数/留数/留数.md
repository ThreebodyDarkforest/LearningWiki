# 留数

之所以叫留数，是因为对任意 $f(z)$ 在 $z_0$ 的洛朗展开式积分后就只留下一项，所以称为留数

$$
Res[f(z), z_0] = c_{-1} = \dfrac{1}{2\pi i}\oint_C f(z)dz
$$

留数有许多有趣的性质和作用，下面一一列出

## 留数的性质

### 曲线积分与孤立奇点

曲线积分与曲线围成区域内的孤立奇点处的留数之和成正相关。**求沿封闭曲线 $C$ 的积分被转化成求被积函数在 $C$ 中的各孤立奇点处的留数。**

函数 $f(z)$ 在 $D$ 内除了在 $z_1, z_2, \cdots, z_n$ 外处处解析，$C$ 是 $D$ 中包围诸奇点的一条正向简单封闭曲线，则

$$
\oint_{C}f(z)dz = 2\pi i\sum_{k = 1}^nRes[f(z), z_k]
$$

其中 $z_1, z_2, \cdots, z_n$ 是 $C$ 内的孤立奇点。

### 留数的计算

- 若 $z_0$ 是可去奇点
    - 若 $z_0$ 不是无穷远点，则 $Res[f(z), z_0] = 0$
    - 若 $z_0$ 是无穷远点，则需要洛朗级数展开求 $c_{-1}$
- 若 $z_0$ 是极点
    - 一级极点：$Res[f(z), z_0] = \underset{z\rightarrow z_0}{\lim}(z - z_0)f(z)$
    - $m$ 级极点：$Res[f(z), z_0] = \dfrac{1}{(m - 1)!}\underset{z\rightarrow z_0}{\lim}\dfrac{d^{m - 1}}{dz^{m - 1}}[(z - z_0)^mf(z)]$
    - 若 $f(z) = \dfrac{P(z)}{Q(z)}$，且 $P(z), Q(z)$ 在 $z_0$ 都解析，如果 $P(z_0) \neq 0, Q(z_0) = 0, Q'(z_0)\neq 0$（$z_0$ 是一级极点），那么 $Res[f(z), z_0] = \dfrac{P(z_0)}{Q'(z_0)}$
- 若 $z_0$ 是本性奇点
    - 洛朗级数展开求 $c_{-1}$
- 若 $z_0$ 是无穷远点
    - 在无穷远点的去心邻域 $R<|z|<+\infty$ 内洛朗级数展开后，$Res[f(z), \infty] = -c_{-1}$
    - 利用 $Res[f(z), \infty] = -Res[f(\dfrac{1}{z})\cdot\dfrac{1}{z^2}, 0]$ 将无穷远点的留数转化为原点留数计算
    - 利用 $Res[f(z), \infty] = -\sum_{k = 1}^nRes[f(z), z_k]$ 将无穷远点留数的计算转化为计算扩充复平面内除了无穷远点外所有（有限个）孤立奇点的留数之和（的相反数）。

## 使用留数计算实变函数定积分

- 形如 $\int_{0}^{2\pi}R(\cos\theta, \sin\theta)d\theta$ 的积分，其中 $R(\cos\theta, \sin\theta)$ 是有理函数，令 $z = e^{i\theta}$，那么

$$
\sin\theta = \dfrac{z^2 - 1}{2iz}
$$

$$
\cos\theta = \dfrac{z^2 + 1}{2z}
$$

于是

$$
\int_{0}^{2\pi}R(\cos\theta, \sin\theta)d\theta = \oint_{|z| = 1}R[\dfrac{z^2 + 1}{2z}, \dfrac{z^2 - 1}{2iz}]\dfrac{dz}{iz}
$$

设 $f(z) = R[\dfrac{z^2 + 1}{2z}, \dfrac{z^2 - 1}{2iz}]\dfrac{1}{iz}$，则积分结果为

$$
2\pi i\sum_{k = 1}^nRes[f(z), z_k]
$$

其中 $z_k$ 是**圆周 $|z| = 1$ 内的所有孤立奇点**。

- 形如 $\int_{-\infty}^\infty R(x)dx$ 的积分

$$
\int_{-\infty}^\infty R(x)dx = 2\pi i\sum_{k = 1}^n Res[R(z), z_k]
$$

其中 $z_k$ 是 $R(z)$ 所有在**上半平面的极点**。

> 注：当被积函数 $R(x)$ 是 $x$ 的有理函数，且分母的次数至少比分子高**两**次，$R(z)$ 在实轴上没有孤立奇点时，积分才存在。

- 形如 $\int_{-\infty}^\infty R(x)e^{aix}dx~(a>0)$ 的积分

$$
\int_{-\infty}^\infty R(x)e^{aix}dx = 2\pi i\sum_{k = 1}^n Res[R(z)e^{aiz}, z_k]
$$

其中 $z_k$ 是 $R(z)$ 所有在**上半平面的极点**。

> 注：当被积函数 $R(x)$ 是 $x$ 的有理函数，且分母的次数至少比分子高**一**次，$R(z)$ 在实轴上没有孤立奇点时，积分才存在。