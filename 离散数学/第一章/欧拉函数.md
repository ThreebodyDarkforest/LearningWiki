# 欧拉函数

欧拉函数 $\phi (m)$ 定义为不超过 $m$ 且与 $m$ 互质的正整数的个数。

$$
\phi(m) = \sum_{0 < n 
\le m}[gcd(n, m) = 1]
$$

特别地，定义 $\phi(1) = 1$。

先给出结论，欧拉函数可以被如下方式计算（$p$ 为质数）

$$
\phi(m) = m\prod_{p | m}(1 - \dfrac{1}{p})
$$

证明需要用到好几个引理，且听我慢慢道来。

## 欧拉函数计算公式的证明

> 引理1：若 $\gcd(a, m) = 1, \gcd(b, m) = 1$，则 $\gcd(ab, m) = 1$，反之亦然。

* 证明

设集合 $\mathcal{A} = \{p| p | a, p \in Z\}$，同理设 $\mathcal{B}, \mathcal{M}$（$a, b, m$ 的质因子集合），则有 $\forall p, p | ab$，那么 $p\subset \mathcal A\cup \mathcal B$，由 $\gcd(a, m) = 1, \gcd(b, m) = 1$ 可知 $\mathcal A \cap \mathcal M = \varnothing, \mathcal B \cap \mathcal M = \varnothing$，则 $A\cup \mathcal B \not\subseteq \mathcal{M}$，故 $\forall p, p \not\in \mathcal{M}$，推知 $\gcd(ab, m) = 1$。反向的推导也可以用集合证明，此处不再赘述。

一句话：没有公因子。

> 引理2：若 $a_1, a_2,\cdots, a_{\phi(m)}$ 是一个和 $m$ 互质的模 $m$ 完整剩余系，且 $\gcd(k, m) = 1$，则
> $$
ka_1, ka_2,\cdots, ka_{\phi(m)}
$$
> 也是这样的剩余系。

* 证明

用反证法。由引理2假设可得 $\gcd(a_i, m) = 1$ ，又根据引理1可知 $\gcd(ka_i, m) = 1$。假设 $i \neq j$ 且 $ka_i \equiv ka_j\pmod m$ 即 $ka_1, ka_2,\cdots, ka_{\phi(m)}$ 不是完整剩余系，则 $a_i \equiv a_j\pmod m$，则必有 $i = j$，故 假设不成立，原设成立。

 > 引理3：假定 $\gcd(m, m') = 1$，$a$ 取遍一个模 $m$ 完整剩余系中的数，$a'$ 取遍一个模 $m'$ 完整剩余系中的数。则 $a'm + am'$ 取遍一个模 $mm'$ 完整剩余系中的数。

 * 证明

用反证法。假设 $a_1' \neq a_2', a_1\neq a_2$ 且有

$$
a_1'm + a_1m' \equiv a_2'm + a_2m' \pmod{mm'}
$$

由 $\gcd(m, m') = 1$ 可得

$$
a_1'm + a_1m' \equiv a_2'm + a_2m' \pmod{m}
$$

则

$$
a_1m' \equiv a_2m'\pmod m
$$

进一步可得

$$
a_1\equiv a_2 \pmod m
$$

则 $a_1 = a_2$，与假设矛盾。

> 引理4：若 $\gcd(m, m') = 1$，则 $\phi(mm') = \phi(m)\phi(m')$，即欧拉函数是乘性的。

不妨假设引理3中所设的 $a,a'$ 都满足 $0 \le a' < m', 0 \le a < m$，可得 $a'm + am'$ 取遍一个模 $mm'$ 完整剩余系中的满足 $0 \le a'm + am' < mm'$ 的数。

由引理1，可得

$$
\begin{aligned}
    \gcd(a'm + am', mm') = 1 \Leftrightarrow 
    &\gcd(a'm + am', m) = 1\\
    & 且 \gcd(a'm + am', m') = 1
\end{aligned}
$$

进一步有

$$
\begin{aligned}
    &\gcd(a'm + am', m) = 1\\
    & 且 \gcd(a'm + am', m') = 1\\
\end{aligned}
\Leftrightarrow \gcd(am', m) = 1 且 \gcd(a'm, m') = 1\\
$$

再用一次引理1就得到

$$
\gcd(a, m) = 1 且 \gcd(a', m') = 1
$$

这是什么意思呢？就是说与 $mm'$ 互质且小于它的数，肯定可以从与 $m$ 互质且小与它的数 $a$ 和与 $m'$ 互质且小于它的数 $a'$ 产生出来，根据乘法原理和引理2，$a, a'$ 的集合的所有 $a'm + am'$ 组合刚好是 $\phi(m)\phi(m')$ 个，同时根据引理3可以知道这些组合跟与 $mm'$ 互质且小于它的数是相同的，那么就有 $\phi(mm') = \phi(m)\phi(m')$。

> 定理：欧拉函数
> $$
\phi(m) = m\prod_{p | m}(1 - \dfrac{1}{p})
$$

直接统计与 $m$ 互质的正整数的个数是比较困难的，正难则反，我们不妨先考虑不互质的情况。

对于任意质数 $p$，假设有 $p^c | m$，先考虑 $\phi(p^c)$。同样地，我们先考虑不互质的情况，显然，$\gcd(np, p^c) \neq 1, n\in Z$，那么总共有 $\dfrac{p^c}{p} = p^{c - 1}$ 个这样的数，然后再考虑 $1$。则总共有 $p^c - 1 - (p^{c - 1} - 1) = p^c(1 - \dfrac{1}{p})$ 个与 $m$ 互质且小于它的正整数，故

$$
\phi(p^c) = p^c(1 - \dfrac{1}{p})
$$

$$
\phi(m) = \prod_{p|m}\phi(p^c) = \prod_{p|m} p^c(1 - \dfrac{1}{p}) = m\prod_{p | m}(1 - \dfrac{1}{p})
$$

> 欧拉，您真是个神仙。

## 欧拉定理

若 $\gcd(a, n) = 1$ 则

$$
a^{\phi(n)} \equiv 1\pmod n
$$