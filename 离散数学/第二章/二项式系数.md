# 二项式系数

## 写在前面

二项式系数其实就是组合数

$$
\binom{n}{k}
$$

至于为什么叫二项式系数，是因为它出现在二项式定理中

$$
(x + y)^n = \sum_{k = 0}^n \binom{n}{k}x^ky^{n - k}
$$

* 二项式系数在算法分析中出现的频率相当高。

## 帕斯卡三角

* 帕斯卡三角是直观地研究二项式系数的良好材料，它是一种组织二项式系数的值的方式。

帕斯卡三角由帕斯卡递推式生成

$$
\binom{n}{k} = \binom{n}{k - 1} + \binom{n - 1}{k - 1}
$$

![Screenshot-from-2022-11-05-11-56-39.png](http://image.tjzfile.xyz/images/2022/11/05/Screenshot-from-2022-11-05-11-56-39.png)

## 二项式系数的特殊性质

根据二项式系数本身的定义，即 $n$ 元素集合的 $k$ 子集，或它的形式化定义

$$
\binom{n}{k} = \dfrac{n!}{(n - k)!k!}
$$

可以从组合学论证的角度或数学推导得到一些有趣且有用的等式。

### 帕斯卡递推公式

提过多次，不再赘述。

$$
\binom{n}{k} = \binom{n}{k - 1} + \binom{n - 1}{k - 1}
$$

### 组合数和公式

* 对同一集合的所有可能子集取法进行求和

$$
\sum_{k = 0}^n\binom{n}{k} = 2^n
$$

还有另一个求和公式，它是由帕斯卡递推公式递归得到的

* 对不同集合的 $k-$子集 进行求和

$$
\sum_{i = 0}^n\binom{i}{k} = \binom{n + 1}{k + 1}
$$

> 注：在帕斯卡三角形上可以直观地看出这一过程，即从某个指定数开始不断用帕斯卡递推式递归它上面那个数，递归边界为顶端的 $1$。最后得到该数左边一列数之和与之相等。
> ![Screenshot-from-2022-11-05-12-14-44.png](http://image.tjzfile.xyz/images/2022/11/05/Screenshot-from-2022-11-05-12-14-44.png)

### 组合数降阶公式

这个公式可以直接从定义推出，但是它十分有用，尤其是进行一些和式的推导时，它可以将一系列变数 $k$ 化为常数 $n$

$$
k\binom{n}{k} = n\binom{n - 1}{k - 1}
$$

### 范徳蒙德卷积

从含 $n + m$ 个元素的全集 $S$ 的两个互斥子集 $S_1, S_2$ 分别取元素，使取得元素的总和为 $k$，这种取法的所有可能性之和与在 $S$ 中取 $k$ 个元素相当。

$$
\sum_{i = 0}^k \binom{n}{i}\binom{m}{k - i} = \binom{n + m}{k}
$$

令 $k = m = n$，并根据组合数的对称性，得到

$$
\sum_{k = 0}^n\binom{n}{k}^2 = \binom{2n}{n}
$$

> 注：这玩意很像超几何分布，或许应该说这个计数问题完整刻画了超几何分布的样本空间。让我们来看一下超几何分布
>$$
P(X = k) = \dfrac{\binom{M}{k}\binom{N}{n - k}}{\binom{N + M}{n}}
$$
> 显然有
>$$
\sum_{k = 0}^{n} P(X = k) = 1
$$
> 然后这个玩意就是范徳蒙德卷积。实际上，之所以叫超几何分布，是因为这个式子满足超几何函数，进一步研究可以参考[这篇文章](https://www.cnblogs.com/szdytom/p/the-application-of-a-set-of-identities.html)，还有这篇文章参考的[这篇文章](https://www.luogu.com.cn/blog/foreverlasting/yi-lei-heng-deng-shi-di-ying-yong-zha-shi-liao-zha-shi-liao-post)（雾）。

## 二项式定理的特殊形式

对二项式定理中的 $x, y$ 取一些特殊的值，可以得到一些有用的结论。

$$
(x + y)^n = \sum_{k = 0}^n \binom{n}{k}x^ky^{n - k}
$$

（1）令 $x = 1, y = 1$，得到组合数和公式

$$
\sum_{k = 0}^n\binom{n}{k} = 2^n
$$

（2）令 $x = 1, y = -1$，得到交错和

$$
\binom{n}{0} - \binom{n}{1} + \binom{n}{2} -\cdots + (-1)^n\binom{n}{n} = 0,\ \ (n \ge 1)
$$

移项得

$$
\binom{n}{0} + \binom{n}{2} + \cdots = \binom{n}{1} + \binom{n}{3} + \cdots,\ \ (n\ge 1)
$$

即二项式系数的偶数项之和与奇数项相等。

由（1）可知等式左右两端之和为 $2^n$，故它们各自等于 $2^{n - 1}$。

（3）令 $y = 1$，得到

$$
\sum_{k = 0}^n\binom{n}{k}x^k = (1 + x)^n
$$

对 $x$ 求导可得

$$
\sum_{k = 0}^nk\binom{n}{k}x^{k - 1} = n(1 + x)^{n - 1}
$$

取 $x = 1$ 得

$$
\sum_{k = 0}^n k\binom{n}{k} = n2^{n - 1}
$$

依此法不断求导，再令 $x = 1$，可分别得

$$
\sum_{k = 0}^nk^p\dfrac{n}{k}
$$

的解析式。

> 注：
> 重要结论
> $$
\sum_{k = 0}^n k\binom{n}{k} = n2^{n - 1}
$$
> 也可以由降阶公式得到
> $$
k\binom{n}{k} = n\binom{n - 1}{k - 1}
$$
>$$
\sum_{k = 0}^n k\binom{n}{k} = n\sum_{k = 1}^n\binom{n - 1}{k - 1} = n2^{n - 1}
$$