# 信号的运算

## 一些没什么好说的

* 首先是信号的加减乘除，就是正常的函数四则运算，序列的话就是对应离散值的四则运算。
* 信号的变换，反转、平移和尺度变换，就是函数变换。这个也实在没有什么好说的，怎么感觉是初中学的玩意。

> 注：听说很多人搞错信号变换？嗯，其实我初中的时候也经常写错，所以还是注意一点。

## 信号的分解与合成

### 直流分量和交流分量

**信号的平均值即为信号的直流分量**，原信号减去直流分量得到交流分量。

$$
f(t) = f_D + f_A(t)
$$
### 奇分量和偶分量

信号还可以分解为奇分量 $f_o(t)$ 和偶分量 $f_e(t)$ 。它们满足如下关系：

$$
f_e(t) = \dfrac{1}{2}[f(t) + f(-t)]
$$

$$
f_o(t) = \dfrac{1}{2}[f(t) - f(-t)]
$$

### 脉冲分解

* 任意信号可以近似为一系列门函数（阶跃函数），可以分解为不同时刻的不同强度的沖激信号之和。

![Screenshot-from-2022-10-08-16-41-52.png](http://image.tjzfile.xyz/images/2022/10/08/Screenshot-from-2022-10-08-16-41-52.png)

> 注：任何离散信号都可以被视为一系列离散的沖激信号。

### 正交分解

* 复杂信号的正交分解是傅里叶级数的数学基础，其思想源于线性代数和微积分的融合。

设两函数 $f(x), g(x)$，若有

$$
\int_a^b f(x)g(x)dx = 0
$$

则称这两函数正交。这一定义是从线性代数引申到微积分上的概念，让我们来讨论一下它的意义。

实际上，任意一元函数都可以视为无穷维的向量，向量中的每个分量都是一个函数邻域内的函数值。这向量也可以被描述为无穷个沖激函数的集合，它们具有相似的意义。

定义在 $[a, b]$ 的一元函数 $f(x)$ 可以（非数学严格意义地）写成如下形式

$$
f(x) = (f(a), f(a + \Delta x), \cdots, f(a + n\Delta x), f(b)), \Delta x \rightarrow 0
$$

根据线性代数的知识，我们知道某些特定的一组具有如上形式的 $n + 2$ 维的向量可以组成一个正交基，通过它我们便可以线性组合出任意的（作为向量的）函数。当然，反之任意函数也可以被分解为某组正交基的线性组合，这便是正交分解在信号处理中的意义。

> 注：线性代数中两向量正交定义为它们的内积为 $0$。

那么，正交函数的意义就呼之欲出了——它实际上就是向量正交在实函数上的拓展概念，因为函数可以被表示成向量。这样一来，上文中的定义就是显然的了，之所以写成积分的形式是因为我们上面定义的函数的向量形式直接做内积其实没有严格的数学意义，但是。。。

$f(x)$ 和 $g(x)$ 在 $[a, b]$ 正交则

$$
<f(x), g(x)> = \lim_{\Delta x \rightarrow 0}\sum_{i = 0}^{n + 1} f(a + i\Delta x)g(a + i\Delta x) = 0\\ (a + (n + 1)\Delta x = b)
$$

而写出来你就会发现这个东西神似黎曼和但差个 $\Delta x$，所以你懂的。

> 注：
> （1）一般来说，我们称一组 $n+2$ 个组成正交基的函数为一个正交函数集。需要注意的是，**$n$ 其实是无穷大的**。
> （2）至于为什么使用正交基而不是其它任意的一组向量，是因为正交基显然更加易于处理。

关于如何寻找这组正交基（在信号处理中往往只使用有限个）和他们的系数以使他们的一个线性组合很好地趋近于某个函数，就是正交分解希望完成的工作。

既然只选取有限个函数作为正交基，那么难免存在误差，我们通常通过均方误差度量它。

假设我们要用 $n$ 个相互正交的函数 $\{\phi_i(t)\}_{i = 1}^n$ 的线性组合拟合一个函数 $f(t)$，它们各自的系数为 $\{c_i\}_{i = 1}^n$，则均方误差为

$$
\bar e^2 = \dfrac{1}{\Delta t}\int_{\Delta t}\left[f(t) - \sum_{i = 1}^n c_i\phi_i(t)\right]^2dt
$$

显然，我们希望最小化这个误差，首先要明确，实际上其中 $c_i$ 才是影响误差的变量，因此对其求偏导数得到

$$
\dfrac{\partial \bar e^2}{\partial c_j} = - \dfrac{1}{\Delta t}\int_{\Delta t}\left[f(t) - \sum_{i = 1}^n c_i\phi_i(t)\right]\phi_j(t)dt
$$

令它为 $0$ 可得

$$
\sum_{i = 1}^n\int_{\Delta t}c_i\phi_i(t)\phi_j(t)dt = \int_{\Delta t}f(t)\phi_j(t)dt
$$

因为正交函数集 $\{\phi_i(t)\}_{i = 1}^n$ 的函数两两正交，所以

$$
\sum_{i \neq j}^n\int_{\Delta t}c_i\phi_i(t)\phi_j(t)dt = 0
$$

那么

$$
\int_{\Delta t}f(t)\phi_j(t)dt = \int_{\Delta t}c_j\phi_j(t)\phi_j(t)dt
$$

$$
c_j = \dfrac{\int_{\Delta t}f(t)\phi_j(t)dt}{\int_{\Delta t}\phi_j(t)\phi_j(t)dt} = \dfrac{<f(t), \phi_j(t)>}{<\phi_j(t), \phi_j(t)>}
$$

对于所有 $j\in [1, n]$ 都成立，这样一来，在选定正交函数集和希望拟合的函数 $f(t)$ 后，系数 $\{c_i\}_{i = 1}^n$ 就是好求的了。

#### 三角正交函数集和三角级数

首先，三角函数系是一个正交函数集，证明[在此](https://zhuanlan.zhihu.com/p/341796771)，同济高数也有简要介绍。

将任意函数正交分解为三角函数系的线性组合，就是三角级数展开，这个级数称为傅里叶级数。

$$
f(t) = \dfrac{a_0}{2} + \sum_{n = 1}^\infty[a_n\cos nx + b_n\sin nx]
$$

## 卷积

先丢一个知乎高赞回答在这里解释一下[卷积的意义](https://www.zhihu.com/question/22298352)。用一句话来解释的话，卷积就是一种信号的时序加权求和运算，而具体权重由另一个信号给出。从物理意义上讲，卷积反映了信号在时间上的某种特定累加效果（取决与参与卷积的另一信号）。

> 事实上，更一般的（数学和其他领域，比如图像处理）卷积可以被理解为对对象指定作用域进行的一种由特定加权平均规则（由参与卷积的另一对象）定义的运算方法。
> 
> 这个东西似乎有一丢丢像矩阵乘法？

连续信号的卷积定义如下：

$$
f(t)*g(t) = \int_{-\infty}^\infty f(\tau)g(t - \tau)d\tau
$$

它的计算过程可以被拆解成

* 对 $g(\cdot)$ 进行反转
* 平移 $t$ 个单位变换 $g(\cdot)$ 到原处
* $f(\cdot)$ 与 $g(\cdot)$ 相乘（加权）
* 求乘积的积分（求和）

离散信号的卷积称为卷积和：

$$
f(n) * g(n) = \sum_{m = -\infty}^\infty f(m)g(n - m)
$$

它与连续信号的卷积在性质上几乎没有区别。

### 卷积的性质

卷积的性质跟乘法差不多，唯一要注意的是求导和积分的性质，不一样。

（1）交换律、分配律、结合律。
（2）微分性质（注意那里是等号不是加号）

$$
\dfrac{d}{dt}[f(t)*g(t)] = f(t)\dfrac{dg(t)}{dt} = \dfrac{df(t)}{dt}g(t)
$$

（3）积分性质

$$
\int_{-\infty}^t[f(\tau)*g(\tau)]d\tau = f(t) * \int_{-\infty}^t g(\tau)d\tau = \int_{-\infty}^t f(\tau)d\tau * g(t)
$$

（4）微积分性质

这个性质是从微分性质和积分性质推出来的，对一个卷积先积分再微分（反之亦然），可得

$$
s(t) = f(t) * g(t) = f^{(1)}(t) * g^{(-1)}(t) = f^{(-1)}(t) * g^{(1)}(t)
$$

推广可得

$$
s^{(i)}(t) = f^{(j)}(t) * g^{(i-j)}(t)
$$

（5）时移性质

根据定义，对沖激信号，有

$$
\delta(t - t_0) * \delta(t - t_1) = \delta(t - t_0 - t_1)
$$

这一性质可以推广到任意函数

$$
f(t-t_1) * g(t - t_2) = s(t - t_1 - t_2) = f(t - t_2) * g(t - t_1)
$$

> 注：这一性质可以用沖激函数简单证明（将 $f$， $g$ 拆成其本身与沖激函数的卷积）。

#### 阶跃和沖激函数的卷积

* 实际上，卷积运算一开始就是为冲激信号设计的。

$$
f(t) * \delta(t - t_0) = \int_{-\infty}^\infty f(\tau)\delta(t - t_0 - \tau)d\tau= f(t - t_0)
$$ 

> 注：也就是说，任意函数与沖激信号的卷积等价于一次时移。

根据微积分性质

$$
f(t) * \delta'(t - t_0) = f'(t - t_0)
$$

推广可得

$$
f(t) * \delta^{(n)}(t - t_0) = f^{(n)}(t - t_0)
$$

* 同样地，对于阶跃函数

$$
f(t) * u(t - t_0) = \int_{-\infty}^t f(\tau - t_0)d\tau
$$

## 例题

### 一

* 连续函数和门函数的卷积

![Screenshot-from-2022-10-09-17-40-35.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-40-35.png)
![Screenshot-from-2022-10-09-17-40-44.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-40-44.png)

### 二

* 连续函数和门函数的卷积

![Screenshot-from-2022-10-09-17-40-50.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-40-50.png)
![Screenshot-from-2022-10-09-17-40-56.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-40-56.png)
![Screenshot-from-2022-10-09-17-41-01.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-41-01.png)

### 三

* 卷积的微积分特性的应用

![Screenshot-from-2022-10-09-17-41-49.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-41-49.png)
![Screenshot-from-2022-10-09-17-41-54.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-41-54.png)

### 四

* 离散信号卷积和的求法

![Screenshot-from-2022-10-09-17-42-06.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-42-06.png)
![Screenshot-from-2022-10-09-17-42-16.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-42-16.png)
![Screenshot-from-2022-10-09-17-42-21.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-42-21.png)
![Screenshot-from-2022-10-09-17-42-27.png](http://image.tjzfile.xyz/images/2022/10/09/Screenshot-from-2022-10-09-17-42-27.png)