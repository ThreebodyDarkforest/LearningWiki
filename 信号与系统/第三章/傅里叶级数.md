# 傅里叶级数

## 写在前面

关于时域和频域分析，为什么叫这个名字呢？

* 时域分析给出一个描述系统的**以时间为自变量的**微分方程，分析的是任意时刻的系统状态，给出这些状态量任意时刻的值。
* 频域分析的频指的是**三角级数各项（谐波）的个数**，分析的是这些项的组分对系统的影响，跟炼丹调药差不多。

傅里叶级数又是干什么的呢？

* 傅里叶级数展开是一种非线性拟合方法，用来近似任意函数的，跟泰勒展开差不多是一种东西，只不过泰勒展开用的信息是各阶导数信息，而傅里叶级数用的是任意高维复空间的函数向量的正交分解信息。

关于正交分解，先[在此](../../信号与系统/第一章/信号的运算.md#正交分解)回顾一下函数向量化的基本思想和数学逻辑。总的来说，函数正交分解就是借用了线性代数线性基线性组合的概念来对函数进行分解，这时候线性代数的方法就迁移到这里来了。

## 周期信号的傅里叶级数

首先呈上大名鼎鼎的傅里叶级数：

$$
f(t) = a_0 + \sum_{n = 1}^\infty[a_n\cos(n\omega_0t) + b_n\sin(n\omega_0t)]
$$

在正交分解的章节中，曾提到三角函数系是一个正交函数集，这个其实不难证，就是分情况三角代换性质去证就行，[证明在此](https://zhuanlan.zhihu.com/p/341796771)。

通过均方误差最小化的方法，可以求得系数 $\{a_n\}, \{b_n\}$，它最终是一个内积商的形式（$n > 0$）

$$
a_n = \dfrac{<f(t), \cos(n\omega_0t)>}{<\cos(n\omega_0t), \cos(n\omega_0t)>}, b_n = \dfrac{<f(t), \sin(n\omega_0t)>}{<\sin(n\omega_0t), \sin(n\omega_0t)>}
$$

显然，当级数的项数越多，级数就越趋近于 $f(t)$，当项数趋于无穷时级数就等于 $f(t)$。

![Screenshot-from-2022-11-02-19-57-10.png](http://image.tjzfile.xyz/images/2022/11/02/Screenshot-from-2022-11-02-19-57-10.png)

> 注：
> （1）$f(t)$ 变化越剧烈，它所包含的高频分量越丰富；$f(t)$ 变化越缓慢，它所包含的低频分量越丰富。
> （2）当信号中任一频率分量的幅度（$a_n, b_n$）或相位（$\phi_n$，合成同频率项得到的，下面有）发生变化时，输出波形一般要发生失真。
> （3）如果傅里叶级数是有限级数，那么无论级数取多少项，在靠近 $f(t)$ 跳变点处总会出现一个峰，这称为吉布斯现象。

一般来说，我们更关心**周期信号**的傅里叶级数，毕竟信号传输大多用的还是周期信号调制解调。不妨假设 $f(t)$ 为周期信号，周期为 $T$，角频率 $\omega_0$，那么因为

$$
<\cos(n\omega_0t), \cos(n\omega_0t)> = \int_{\Delta T}\cos^2(n\omega_0t)dt = \dfrac{T}{2}
$$

$$
<\sin(n\omega_0t), \sin(n\omega_0t)> = \int_{\Delta T}\sin^2(n\omega_0t)dt = \dfrac{T}{2}
$$

所以有

$$
a_n = \dfrac{2}{T}\int_{\Delta T}f(t)\cos(n\omega_0t)dt
$$

$$
b_n = \dfrac{2}{T}\int_{\Delta T}f(t)\sin(n\omega_0t)dt
$$

此外，$a_0$ 是直流分量（偏置系数），那么用[直流交流分解](../../信号与系统/第一章/信号的运算.md#直流分量和交流分量)求个直流分量就行。

$$
a_0 = \dfrac{1}{T}\int_{\Delta T}f(t)dt
$$

为了简化形式，将傅里叶级数的三角形式整理如下

$$
f(t) = A_0 + \sum_{n = 1}^\infty A_n\cos(n\omega_0t + \phi_n)
$$

$$
a_n = \dfrac{<f(t), \cos(n\omega_0t)>}{<\cos(n\omega_0t), \cos(n\omega_0t)>} = \dfrac{2}{T}\int_{\Delta T}f(t)\cos(n\omega_0t)dt
$$

$$
b_n = \dfrac{<f(t), \sin(n\omega_0t)>}{<\sin(n\omega_0t), \sin(n\omega_0t)>} = \dfrac{2}{T}\int_{\Delta T}f(t)\sin(n\omega_0t)dt
$$

其中 $A_0 = a_0, A_n = \sqrt{a_n^2 + b_n^2}, \phi_n = -\arctan(\dfrac{b_n}{a_n})$。

> 注：
> （1）$\omega_0 = \dfrac{2\pi}{T}$ 表示基频，频率为 $\omega_0$ 的谐波称为基波。
> （2）$A_n\cos(n\omega_0t)$ 称为信号的 $n$ 次谐波。
> （3）非周期信号也可以通过傅里叶变换写成傅里叶级数，虽然由于引入无穷大这个级数变成了积分就是了。

一般来说，为了计算的简便性，通常用欧拉公式把三角形式的傅里叶级数写成指数型 $\{e^{jn\omega_0t}\}$。

根据欧拉公式

$$
\cos(\omega t) = \dfrac{1}{2}(e^{j\omega t} + e^{-j\omega t}), \sin(\omega t) = \dfrac{1}{2j}(e^{j\omega t} - e^{-j\omega t})
$$

$$
f(t) = a_0 + \sum_{n = -\infty}^\infty[\dfrac{a_n - jb_n}{2}e^{jn\omega_0t} + \dfrac{a_n + jb_n}{2}e^{-jn\omega_0t}] =  \sum_{n = -\infty}^\infty F_n e^{jn\omega_0t}
$$

其中

$$
F_n = \left\{
\begin{aligned}
    &A_0 &,n = 0\\
    &\dfrac{A_n}{2}e^{j\phi_n} &,n > 0\\
    &\dfrac{A_n}{2}e^{-j\phi_n} &,n < 0 
\end{aligned}
\right.
$$

但是这种形式还要用到三角型中的 $\phi_n$ 和 $A_n$，实际上还可以进一步代入 $a_n, b_n$ 的积分去掉。

$$
f(t) = \sum_{n = -\infty}^\infty F_n e^{jn\omega_0t}
$$

$$
F_n = \dfrac{<f(t), e^{jn\omega_0t}>}{<e^{jn\omega_0t}, e^{jn\omega_0t}>} = \dfrac{1}{T}\int_T f(t)e^{-jn\omega_0t}dt
$$

> 注：
> （1）对复变函数搞内积，要注意需要对其中一个复变函数取共轭，这跟向量转置差不多。
> （2）要求任意函数的傅里叶级数分解，实际上最关键就在于求一系列系数 $F_n$（当然求 $a_n, b_n$ 也可以，看要求是三角分解还是指数分解），把要分解的周期函数代入积分式积一个周期即可。

### 狄利克雷条件

* 满足狄利克雷条件的周期函数才能进行傅里叶级数展开。

（1）在**一周期内**，如果有间断点存在，间断点应为有限个。
（2）在一周期内，极大值和极小值的数目应是有限个。
（3）在一周期内，信号是绝对可积的，即 $\int_T|f(t)|dt$ 为有限值。

### 频谱图

频谱图是以傅里叶级数各项的频率作为自变量绘制的图像，它可以按因变量分为幅度图和相位图。一般来说，都以余弦函数形式的傅里叶级数为画图基准。 

傅里叶级数的频谱图是离散的，每个离散值称为谱线，它可以被一条平滑的包络线包络。

* 三角型傅里叶级数频谱图的性质

（1）两种频谱图都是单边谱，只有在 $\omega_0 \ge 0$ 处有值。
（2）每条谱线的间距为 $\Omega = \dfrac{2\pi}{T}$，称为谱线间隔。

* 指数型傅里叶级数频谱图的性质

（1）两种频谱图都是双边谱，根据 $F_n = |F_n|e^{j\phi_n}$ 可以画出复数幅度谱和复数相位谱。
（2）**当** $F_n$ **为实数时，可以用** $F_n$ **的正、负表示** $\phi_n$ **的** $0,\pi$。
（3）复数频谱图都是左右对称的，**只有把正负频率上对应的两条谱线矢量相加才代表一个分量的幅度**，单单一个谱线没有物理意义。

> 注：
> （1）谱线间隔只与 $T$ 有关，随着周期 $T$ 增大，谱线间隔 $\Omega$ 减小。
> （2）当 $T \rightarrow \infty$ 时，谱线间隔趋于无穷小变为连续谱，周期信号变为非周期信号。

![Screenshot-from-2022-11-02-19-56-05.png](http://image.tjzfile.xyz/images/2022/11/02/Screenshot-from-2022-11-02-19-56-05.png)

### 傅里叶级数的功率和能量

* 帕塞瓦尔恒等式

$$
P = \dfrac{1}{T}\int_{-\frac{T}{2}}^\frac{T}{2}f(t)^2dt = A_0^2 + \sum_{n = 1}^\infty \dfrac{A^2}{2} = \sum_{n = -\infty}^\infty|F_n|^2
$$

一个周期的能量的话，不除以 $T$ 就好了。

丢一个证明在这里，主要是强化一下复数的积分和内积这样。

![Screenshot-from-2022-11-02-20-00-17.png](http://image.tjzfile.xyz/images/2022/11/02/Screenshot-from-2022-11-02-20-00-17.png)

### 典型周期信号的傅里叶级数



## 傅里叶变换