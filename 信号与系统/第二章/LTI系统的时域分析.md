# LTI系统的时域分析

## 写在前面

* 再一次拿出这张图，首先要明确本节做的是时域分析。

![Screenshot-from-2022-10-20-18-04-46.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-20-18-04-46.png)

对于线性时不变系统来说，用于描述它的微分方程是常系数微分方程，这意味着系统任意时刻的所有参量实际上都可以被系统参数（常微分方程的系数）、输入和输出信号三个关键信息描述。

当得知微分方程系数、激励函数解析式和响应函数起始值，就可以得到此后任意时刻该系统的状态。因此如果我们想要研究某系统，那么只要研究清楚这个系统对应的微分方程即可。

> 注意：
> （1）信号与系统中的微分方程与高数中描述的并不完全一致，因为这里**引入了阶跃函数和沖激函数**，这意味着部分不连续函数能够无穷阶可导。
> （2）由于沖激的存在，系统状态起始点可能存在跳变，这也是之前的微分方程没有研究过的内容。

本节内容较为复杂（毕竟有很多微分方程的繁琐求解之类），故给出整体思路如下：

* LTI 系统在时域上可以被描述成一个微分方程，那么只要研究这个微分方程便能了解这个系统在各个时刻的状态。
* 但是，由于沖激函数和阶跃函数的引进，微分方程可能存在起始点的跳变，因此需要新的研究方法。
* 可以通过奇异函数系数平衡的方法待定各阶导数系数来求解微分方程。
* 在研究阶跃响应和沖激响应时，发现沖激响应本身就可以刻画整个系统的结构。只需要用激励函数与某系统的**零状态沖激响应**进行一次卷积即可得到该系统对这一激励的相应。
* 此时，不再需要繁琐求解微分方程了。

## 微分方程的时域经典解法

* 回顾一下高数的微分方程解法。

先回顾一下微分方程的构造：

$$
\begin{aligned}
C_0\dfrac{d^nr(t)}{dt^n} + C_1\dfrac{d^{n - 1}r(t)}{dt^{n - 1}} + \cdots + C_{n - 1}\dfrac{dr(t)}{dt} + C_nr(t)\\
= E_0\dfrac{d^ne(t)}{dt^n} + E_1\dfrac{d^{n - 1}e(t)}{dt^{n - 1}} + \cdots + E_{n - 1}\dfrac{de(t)}{dt} + E_ne(t)
\end{aligned}
$$

一般把等式右边 $e(t)$ 视为激励，$r(t)$ 视为响应。

[高等数学的解法](../../高等数学（下）/第九章/二阶线性常系数微分方程.md)大部分仍然是适用的，它相当程序化。对于任意激励，就是先求齐次方程通解（特征方程），再求非齐次方程特解（查表），然后将特解代入微分方程求特解的系数，最后将系统初始状态代入完全解求通解系数。

![Screenshot-from-2022-10-21-04-52-09.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-04-52-09.png)
![Screenshot-from-2022-10-21-04-52-14.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-04-52-14.png)
![Screenshot-from-2022-10-21-04-52-21.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-04-52-21.png)

> 注：在信号与系统中，称通解为自由响应，特解为强迫响应。

## 起始点的跳变

* 由于引入了沖激函数和阶跃函数，起始点可能存在跳变。
* 总的来说，若微分方程等号右端不含有冲激信号及其各阶导数，则系统的初始状态和初始值相等。若微分方程等号右端含有冲激函数及其各阶导数，则需要采用系数匹配法由初始状态求得初始值。

在电路基础课程中学过[换路定则](../../电工电子技术基础/第二章/换路定则.md)，当时在确定系统初始状态 $f(0_+)$ 时，直接给出 $f(0_+) = f(0_-)$，看上去忽略了沖激的作用，但那是没有问题的，因为物理规律告诉我们，电感电流和电容电压不跳变。但是，若要求解整个系统任意时刻的任意参量，就不得不考虑沖激的影响了。

* 可以用积分的方法解决跳变的问题（连续函数在 $0_+$ 到 $0_-$ 的积分为 $0$，沖激的积分不为 $0$）

![Screenshot-from-2022-10-21-05-21-55.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-05-21-55.png)
![Screenshot-from-2022-10-21-05-23-00.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-05-23-00.png)

* 还有一种办法是使用奇异函数系数平衡的待定系数法。

在微分方程中代入具体激励信号后，等号两端同阶奇异函数（沖激函数）系数应相等。

思路为，激励函数中 $\delta(t)$ 的最高阶导数应该在响应函数的最高阶导数中，然后根据奇异函数系数平衡假设相应函数的最高阶导数表达式（待定系数），列写各阶导数表达式并对等式两端积分在 $0_-$ 到 $0_+$ 积分求得起始值 $y(0_+)$。

如：若 $y''(t)$ 含有 $\delta''(t)$，则假设

$$
\begin{aligned}
&y''(t) = a\delta''(t) + b\delta'(t) + c\delta(t) + du(t) + p_0(t)\\
&y'(t) = a\delta'(t) + b\delta(t) + cu(t) + p_1(t)\\
&y(t) = a\delta(t) + bu(t) + p_2(t)
\end{aligned}
$$

![Screenshot-from-2022-10-21-05-51-31.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-05-51-31.png)

> 注：
> （1）$p_k(t)$ 表示任一连续函数，因为它在 $0$ 处的积分为 $0$，无法提供当前问题的有用信息，所以不用求出。
> （2）$\delta(t)$ 的任意阶导数由于在 $0$ 的边缘都没有取值（根据定义），所以积分是 $0$。
> （3）此处用奇异函数平衡求的是起始点的跳变值，即 $y(0_+)$。注意后面又用了一次奇异函数平衡，那是直接绕过了求跳变值的过程，通过待定系数法直接求通解系数（经典方法求通解需要得知起始值）。注意区分。

* 接上题，实际上可以直接通过待定系数法求通解系数，上面已经呼之欲出了，其实就是把各阶 $y(t)$ 导数代回微分方程做待定系数就行了。

![Screenshot-from-2022-10-21-06-07-19.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-06-07-19.png)
![Screenshot-from-2022-10-21-06-09-07.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-06-09-07.png)

> 注：啪的一下，很快啊！

## 零输入响应和零状态响应

* 说完起始点的跳变，就到系统本身对激励的作用的分析了，零输入响应和零状态响应是对全响应的一个有用的分解。

零输入响应：当激励为 $0$，只考虑系统起始状态的响应。即 $e(t) = 0$ 时，考虑 $y(0_+)$ 对系统之后时刻的影响，记为 $y_{zi}(t)$。
零状态响应：当系统起始状态为 $0$，只考虑激励时的响应。即 $y_(0_+) = 0$ 时的响应，记为 $y_{zs}(t)$。

这种分解和自由响应、强迫响应分解相似又有所不同：

![Screenshot-from-2022-10-21-06-49-16.png](http://image.tjzfile.xyz/images/2022/10/20/Screenshot-from-2022-10-21-06-49-16.png)

比较它们的性质可以得出：
（1）自由响应和零输入响应都满足齐次方程的解。
（2）自由响应和零输入响应的系数完全不同。**自由响应同时依赖于起始状态和激励信号**。
（3）零输入响应在起始点不跳变。

> 注：通解的函数特性仅依赖于系统本身，与激励信号的形式无关，因而称为自由响应。但是它的系数跟激励信号有关。特解的形式只与激励信号有关。

## 沖激响应和阶跃响应

> 阶跃响应没什么用，主要还是看沖激响应，它给出了一种用卷积求任意系统状态的方法。

* 单位沖激响应就是以沖激信号 $\delta(t)$ 作为激励，系统产生的